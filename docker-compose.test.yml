proxy:
  image: jwilder/nginx-proxy:latest
  ports:
    - "80:80"
  volumes:
    - "/var/run/docker.sock:/tmp/docker.sock"

db:
  image: postgres:9.5.4 # Heroku PostgreSQL Version
  ports:
    - "5432:5432" # Bind host port 5432 to PostgreSQL port 5432
  volumes_from:
    - dbdata
  environment:
    LC_ALL: C.UTF-8
    POSTGRES_PASSWORD: HowCanYouGuess

dbdata:
  image: postgres:9.5.4
  command: /bin/echo PostgreSQL Data Container

redis:
  image: redis

cache:
  image: memcached

web:
  build: .
  command: npm run dev -s
  ports:
    - "8080:8080"
    - "8079:8079"
  volumes:
    - .:/rails
  environment:
    - SECRET_KEY_BASE=please_enter_here
    - RAILS_ENV=development
    - S3_BUCKET_NAME=please_enter_here
    - S3_ACCESS_KEY=please_enter_here
    - S3_SECRET_ACCESS_KEY=please_enter_here
    - AWS_REGION=please_enter_here
    - STRIPE_PUBLISHABLE_KEY=please_enter_here
    - STRIPE_SECRET_KEY=please_enter_here
  links:
    - db
    - redis
    - cache
